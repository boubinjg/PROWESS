{"ast":null,"code":"import _classCallCheck from\"/home/boubin.2/PROWESS/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/boubin.2/PROWESS/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/boubin.2/PROWESS/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/boubin.2/PROWESS/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/boubin.2/PROWESS/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import Scheduler from'../components/Scheduler';import'react-dates/initialize';import DatePicker from\"react-datepicker\";import moment from\"moment\";import{DateRangePicker,SingleDatePicker,DayPickerRangeController}from'react-dates';import'react-dates/lib/css/_datepicker.css';import'antd/dist/antd.css';import{TimePicker}from'antd';import momentPropTypes from'react-moment-proptypes';import{Table,Form,FormGroup,Checkbox,Col,Button,Navbar,Nav,NavDropdown,FormControl}from\"react-bootstrap\";import'bootstrap/dist/css/bootstrap.min.css';import'../App.css';import $ from'jquery';import{saveAs}from'file-saver';import*as JSZip from'jszip';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var data=[];var cfg=require('../config.json');var util=require('util');var Delete=/*#__PURE__*/function(_Component){_inherits(Delete,_Component);var _super=_createSuper(Delete);function Delete(props){var _this;_classCallCheck(this,Delete);_this=_super.call(this,props);_this.state={user:'default',startdate:null,enddate:null,starttime:moment('00:00:00','HH:mm:ss').format('HH:mm:ss'),endtime:moment('00:00:00','HH:mm:ss').format('HH:mm:ss'),focusedEnd:false,container:null,allMics:false,mic1:false,mic2:false,mic3:false,cam1:false,cam2:false,cam3:false,allCams:false,allSens:false,sdr:false,gpu:false,test:'test',expdescription:'',id:0,calendarData:[],myExps:[],currentIds:[]};_this.handleSubmit=_this.handleSubmit.bind(_assertThisInitialized(_this));_this.handleChange=_this.handleChange.bind(_assertThisInitialized(_this));_this.fetch=_this.fetch.bind(_assertThisInitialized(_this));_this.fetchMyExps=_this.fetchMyExps.bind(_assertThisInitialized(_this));return _this;}_createClass(Delete,[{key:\"handleChange\",value:function handleChange(time,variable){if(variable=='starttime')this.setState({starttime:time.format('HH:mm:ss')});else if(variable=='endtime')this.setState({endtime:time.format('HH:mm:ss')});}},{key:\"handleSubmit\",value:function handleSubmit(event){event.preventDefault();var jsondata={user:this.state.user,container:this.state.container,StartDate:this.state.startdate.format('YYYY-MM-DD'),endDate:this.state.enddate.format('YYYY-MM-DD'),starttime:this.state.starttime,endtime:this.state.endtime,description:this.state.expdescription,all_sensors:this.state.allSens,all_mics:this.state.allMics,mic1:this.state.mic1,mic2:this.state.mic2,mic3:this.state.mic3,all_cams:this.state.allCams,cam1:this.state.mic1,cam2:this.state.mic2,cam3:this.state.mic3,gpu:this.state.gpu,sdr:this.state.sdr};console.log(jsondata);var expStart=this.state.startdate.format('YYYY-MM-DD');var expStartTime=this.state.starttime;var expEnd=this.state.enddate.format('YYYY-MM-DD');var expEndTime=this.state.endtime;var text=this.state.container+'\\n'+this.state.expdescription;var newExp={start_date:expStart+' '+expStartTime,end_date:expEnd+' '+expEndTime,text:text,id:this.state.id};console.log(jsondata.endDate);//this.setState({calendarData: this.state.calendarData.concat(newExp)})\n//this.setState({id: this.state.id+1})\n$.ajax({url:cfg.domain+':'+cfg.backendPort+'/post',type:'POST',data:jsondata,success:function success(msg){console.log(msg);},error:function error(request,status,_error){alert(request.responseText);}});this.fetch();}},{key:\"fetchShib\",value:function fetchShib(){var _this2=this;var context=this;fetch('https://'+cfg.domain+'/Shibboleth.sso/Session').then(function(response){return response.json();}).then(function(jsonData){console.log(jsonData);console.log('$$$$$$$$$$$$$$$$$$$');var UID=jsonData.attributes[4].values[0].split('@')[0];console.log(jsonData.attributes[4].values[0].split('@')[0]);console.log(UID);_this2.setState({user:UID});console.log('User');console.log(_this2.state.user);console.log('$$$$$$$$$$$$$$$$$$$');_this2.fetchMyExps();}).catch(function(error){console.error(error);});}},{key:\"fetchMyExps\",value:function fetchMyExps(){var context=this;var jsondata={user:this.state.user};$.ajax({url:'https://'+cfg.domain+':'+cfg.backendPort+'/postExps',type:'POST',data:jsondata,success:function success(response){context.setState({myExps:response.message});console.log(util.inspect(response));}});}},{key:\"fetch\",value:function fetch(){var context=this;$.ajax({url:'https://'+cfg.domain+':'+cfg.backendPort+'/api',method:'GET',data:data,success:function success(response){context.setState({calendarData:response.message});}});}},{key:\"componentDidMount\",value:function componentDidMount(){console.log('Mounting!');this.fetch();this.fetchShib();this.fetchMyExps();}},{key:\"handleButtonInput\",value:function handleButtonInput(e){console.log(e.target.value);var context=this;var data={user:this.state.user,idx:e.target.value};console.log(data);$.ajax({url:'https://'+cfg.domain+':'+cfg.backendPort+'/postDel',method:'post',data:data,success:function success(response){}});this.fetch();this.fetchMyExps();}},{key:\"handleDownload\",value:function handleDownload(e){console.log(e.target.value);var context=this;var user=this.state.user;var idx=e.target.value;console.log(data);window.open('https://'+cfg.domain+':'+cfg.backendPort+'/download?user='+user+'&idx='+idx);this.fetch();this.fetchMyExps();}},{key:\"myExperiments\",value:function myExperiments(){var _this3=this;console.log('MyExps: ');console.log(util.inspect(this.state.myExps));var list=[];var self=this;for(var i=0;i<this.state.myExps.length;i++){var exp=this.state.myExps[i];var label='Container: '+exp.container+' ';var idx=exp.id;this.state.currentIds.push(idx);var buttonVar=\"primary\";if(exp.status.substring(0,5)=='error')buttonVar=\"danger\";var bv=\"\";if(exp.status.substring(0,8)=='Complete'){var bv=/*#__PURE__*/_jsx(Button,{value:idx,variant:buttonVar,type:\"submit\",onClick:function onClick(e){return _this3.handleDownload(e,\"value\");},children:\"Download Results\"});}var listItem=/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:exp.id}),/*#__PURE__*/_jsx(\"td\",{children:exp.container}),/*#__PURE__*/_jsx(\"td\",{children:exp.start_date}),/*#__PURE__*/_jsx(\"td\",{children:exp.end_date}),/*#__PURE__*/_jsxs(\"td\",{children:[exp.status,\" \",/*#__PURE__*/_jsx(\"br\",{}),\" \",bv,\" \"]}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Button,{value:idx,variant:buttonVar,type:\"submit\",onClick:function onClick(e){return _this3.handleButtonInput(e,\"value\");},children:\"Delete\"})})]});list.push(listItem);}console.log('CURRENT IDS:');console.log(this.state.currentIds);return list;}},{key:\"render\",value:function render(){var exps=this.myExperiments();return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(Navbar,{className:\"color-nav\",expand:\"xl\",children:[/*#__PURE__*/_jsx(Navbar.Brand,{href:\"#home\",children:\"Pomerene Lab IoT Testbed Experiment Scheduler\"}),/*#__PURE__*/_jsx(Navbar.Toggle,{\"aria-controls\":\"basic-navbar-nav\"}),/*#__PURE__*/_jsx(Navbar.Collapse,{id:\"basic-navbar-nav\",children:/*#__PURE__*/_jsxs(Nav,{className:\"mr-auto\",children:[/*#__PURE__*/_jsx(Nav.Link,{href:\"/\",children:\"Schedule a New Experiment\"}),/*#__PURE__*/_jsx(Nav.Link,{href:\"/Delete\",children:\"View My Scheduled Experiments\"})]})})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"conatainer\",children:[/*#__PURE__*/_jsx(\"div\",{class:\"row\",children:/*#__PURE__*/_jsxs(\"div\",{class:\"col-xl\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"h1\",{children:\"View My Scheduled Experiments\"})}),/*#__PURE__*/_jsxs(Table,{striped:true,bordered:true,hover:true,children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Experiment ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Container\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Start Time\"}),/*#__PURE__*/_jsx(\"th\",{children:\"End Time\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Delete\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:exps})]})]})}),/*#__PURE__*/_jsx(\"div\",{class:\"row\",children:/*#__PURE__*/_jsx(\"div\",{className:\"scheduler-container\",children:/*#__PURE__*/_jsx(Scheduler,{events:this.state.calendarData})})})]})]});}}]);return Delete;}(Component);export default Delete;","map":{"version":3,"sources":["/home/boubin.2/PROWESS/Frontend/src/components/Delete.js"],"names":["React","Component","Scheduler","DatePicker","moment","DateRangePicker","SingleDatePicker","DayPickerRangeController","TimePicker","momentPropTypes","Table","Form","FormGroup","Checkbox","Col","Button","Navbar","Nav","NavDropdown","FormControl","$","saveAs","JSZip","data","cfg","require","util","Delete","props","state","user","startdate","enddate","starttime","format","endtime","focusedEnd","container","allMics","mic1","mic2","mic3","cam1","cam2","cam3","allCams","allSens","sdr","gpu","test","expdescription","id","calendarData","myExps","currentIds","handleSubmit","bind","handleChange","fetch","fetchMyExps","time","variable","setState","event","preventDefault","jsondata","StartDate","endDate","description","all_sensors","all_mics","all_cams","console","log","expStart","expStartTime","expEnd","expEndTime","text","newExp","start_date","end_date","ajax","url","domain","backendPort","type","success","msg","error","request","status","alert","responseText","context","then","response","json","jsonData","UID","attributes","values","split","catch","message","inspect","method","fetchShib","e","target","value","idx","window","open","list","self","i","length","exp","label","push","buttonVar","substring","bv","handleDownload","listItem","handleButtonInput","exps","myExperiments"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport Scheduler from '../components/Scheduler';\nimport 'react-dates/initialize';\nimport DatePicker from \"react-datepicker\"\nimport moment from \"moment\"\nimport { DateRangePicker, SingleDatePicker, DayPickerRangeController } from 'react-dates';\nimport 'react-dates/lib/css/_datepicker.css';\nimport 'antd/dist/antd.css'\nimport { TimePicker } from 'antd'\nimport momentPropTypes from 'react-moment-proptypes'\nimport PropTypes from 'prop-types'\nimport {Table, Form, FormGroup, Checkbox, Col, Button, Navbar, Nav, NavDropdown,FormControl} from \"react-bootstrap\"\nimport 'bootstrap/dist/css/bootstrap.min.css'\nimport '../App.css';\nimport $ from 'jquery';\nimport { saveAs } from 'file-saver'\nimport * as JSZip from 'jszip'\n\nconst data = [];\nconst cfg = require('../config.json')\n\nconst util = require('util')\n\nclass Delete extends Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n                        user: 'default',\n                        startdate: null,\n                        enddate:  null,\n                        starttime: moment('00:00:00', 'HH:mm:ss').format('HH:mm:ss'),\n                        endtime:  moment('00:00:00', 'HH:mm:ss').format('HH:mm:ss'),\n                        focusedEnd: false,\n                        container: null,\n                        allMics: false,\n                        mic1: false,\n                        mic2: false,\n                        mic3: false,\n                        cam1: false,\n                        cam2: false,\n                        cam3: false,\n                        allCams: false,\n                        allSens: false,\n                        sdr: false,\n                        gpu: false,\n                        test: 'test',\n                        expdescription: '',\n                        id: 0,\n                        calendarData: [],\n                        myExps: [],\n                        currentIds: []\n                    };\n        this.handleSubmit = this.handleSubmit.bind(this);\n        this.handleChange = this.handleChange.bind(this);\n        this.fetch = this.fetch.bind(this);\n        this.fetchMyExps = this.fetchMyExps.bind(this);\n    }\n    handleChange(time, variable){\n        if(variable == 'starttime')\n            this.setState({starttime: time.format('HH:mm:ss')})\n        else if(variable == 'endtime')\n            this.setState({endtime: time.format('HH:mm:ss')})\n    }\n    handleSubmit(event){\n        event.preventDefault();\n        var jsondata = {user: this.state.user,\n                    container: this.state.container,\n                    StartDate: this.state.startdate.format('YYYY-MM-DD'),\n                    endDate: this.state.enddate.format('YYYY-MM-DD'),\n                    starttime: this.state.starttime,\n                    endtime: this.state.endtime,\n                    description: this.state.expdescription,\n                    all_sensors: this.state.allSens,\n                    all_mics: this.state.allMics,\n                    mic1: this.state.mic1,\n                    mic2: this.state.mic2,\n                    mic3: this.state.mic3,\n                    all_cams: this.state.allCams,\n                    cam1: this.state.mic1,\n                    cam2: this.state.mic2,\n                    cam3: this.state.mic3,\n                    gpu: this.state.gpu,\n                    sdr: this.state.sdr\n                }\n\n        console.log(jsondata)\n\n        var expStart = this.state.startdate.format('YYYY-MM-DD')\n        var expStartTime = this.state.starttime\n        var expEnd = this.state.enddate.format('YYYY-MM-DD')\n        var expEndTime = this.state.endtime\n        var text = this.state.container + '\\n' + this.state.expdescription\n        var newExp = {start_date: expStart +' '+ expStartTime, end_date: expEnd+' '+expEndTime,text: text, id: this.state.id}\n\n        console.log(jsondata.endDate)\n\n        //this.setState({calendarData: this.state.calendarData.concat(newExp)})\n        //this.setState({id: this.state.id+1})\n\n        $.ajax({\n            url: cfg.domain+':'+cfg.backendPort+'/post',\n            type: 'POST',\n            data: jsondata,\n            success: function(msg) {\n                console.log(msg);\n            },\n            error: function(request, status, error){\n                    alert(request.responseText);\n            }\n        });\n        this.fetch()\n    }\n    fetchShib() {\n    \tvar context = this;\n\tfetch('https://'+cfg.domain+'/Shibboleth.sso/Session')\n  \t\t.then(response => response.json())\n  \t\t.then((jsonData) => {\n    \t     \t\tconsole.log(jsonData)\n\t\t\tconsole.log('$$$$$$$$$$$$$$$$$$$')\n                        const UID = jsonData.attributes[4].values[0].split('@')[0]\n\t\t\tconsole.log(jsonData.attributes[4].values[0].split('@')[0])\n\t\t\tconsole.log(UID)\n\t\t\tthis.setState({ user: UID})\n\t\t\tconsole.log('User')\n\t\t\tconsole.log(this.state.user)\n\t\t\tconsole.log('$$$$$$$$$$$$$$$$$$$')\n\t\t\tthis.fetchMyExps()\n   \t\t})\n               .catch((error) => {\n                 console.error(error)\n               })\n    }\n\n    fetchMyExps() {\n        var context = this;\n        var jsondata = {user: this.state.user}\n\n        $.ajax({\n            url: 'https://'+cfg.domain+':'+cfg.backendPort+'/postExps',\n            type: 'POST',\n            data: jsondata,\n            success: function(response) {\n                context.setState({\n                    myExps: response.message\n                });\n                console.log(util.inspect(response))\n            }\n        });\n    }\n    fetch() {\n        var context = this;\n\n        $.ajax({\n            url: 'https://'+cfg.domain+':'+cfg.backendPort+'/api',\n            method: 'GET',\n            data: data,\n            success: function(response) {\n                context.setState({\n                    calendarData: response.message\n                });\n            }\n        });\n    }\n    componentDidMount(){\n        console.log('Mounting!')\n        this.fetch();\n\tthis.fetchShib();\n        this.fetchMyExps();\n    }\n    handleButtonInput(e) {\n        console.log(e.target.value)\n        var context = this\n        var data = {user: this.state.user, idx: e.target.value}\n        console.log(data)\n        $.ajax({\n            url: 'https://'+cfg.domain+':'+cfg.backendPort+'/postDel',\n            method: 'post',\n            data: data,\n            success: function(response) {\n            }\n        });\n        this.fetch();\n        this.fetchMyExps();\n    }\n    handleDownload(e) {\n        console.log(e.target.value)\n        var context = this;\n        var user = this.state.user;\n\tvar idx = e.target.value;\n        console.log(data)\n\n\twindow.open('https://'+cfg.domain+':'+cfg.backendPort+'/download?user='+user+'&idx='+idx)\n\n\n        this.fetch();\n        this.fetchMyExps();\n    }\n\n    myExperiments(){\n        console.log('MyExps: ')\n        console.log(util.inspect(this.state.myExps))\n        var list = []\n        const self = this;\n        for(var i=0; i<this.state.myExps.length; i++){\n            var exp = this.state.myExps[i]\n            var label = 'Container: '+exp.container+' '\n            var idx = exp.id\n            this.state.currentIds.push(idx)\n            var buttonVar = \"primary\"\n\t    if(exp.status.substring(0,5) == 'error')\n\t        buttonVar = \"danger\"\n\t    var bv = \"\"\n\t    if(exp.status.substring(0,8) == 'Complete') {\n\n\t    \tvar bv =  <Button value={idx} variant={buttonVar} type=\"submit\" onClick={e => this.handleDownload(e, \"value\")} >\n                            Download Results\n                        </Button>\n\t    }\n\t    var listItem =\n                <tr>\n                    <td>{exp.id}</td>\n                    <td>{exp.container}</td>\n                    <td>{exp.start_date}</td>\n                    <td>{exp.end_date}</td>\n\t\t    <td>{exp.status} <br/> {bv} </td>\n                    <td>\n                        <Button value={idx} variant={buttonVar} type=\"submit\" onClick={e => this.handleButtonInput(e, \"value\")} >\n                            Delete\n                        </Button>\n                    </td>\n                </tr>\n            list.push(listItem)\n        }\n        console.log('CURRENT IDS:')\n        console.log(this.state.currentIds)\n        return list\n    }\n    render() {\n        const exps = this.myExperiments()\n\n        return (\n            <div>\n                <Navbar className=\"color-nav\" expand='xl'>\n                  <Navbar.Brand href=\"#home\">Pomerene Lab IoT Testbed Experiment Scheduler</Navbar.Brand>\n                  <Navbar.Toggle aria-controls=\"basic-navbar-nav\" />\n                  <Navbar.Collapse id=\"basic-navbar-nav\">\n                    <Nav className=\"mr-auto\">\n                      <Nav.Link href=\"/\">Schedule a New Experiment</Nav.Link>\n                      <Nav.Link href=\"/Delete\">View My Scheduled Experiments</Nav.Link>\n                    </Nav>\n                 </Navbar.Collapse>\n                </Navbar>\n\n                <div class=\"conatainer\">\n                <div class='row'>\n                <div class='col-xl'>\n                <div>\n                    <h1>View My Scheduled Experiments</h1>\n                </div>\n                <Table striped bordered hover>\n                    <thead>\n                        <tr>\n                            <th>Experiment ID</th>\n                            <th>Container</th>\n                            <th>Start Time</th>\n                            <th>End Time</th>\n\t\t\t    <th>Status</th>\n                            <th>Delete</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {exps}\n                    </tbody>\n                </Table>\n                </div>\n                </div>\n                <div class=\"row\">\n                <div className='scheduler-container'>\n                    <Scheduler events={this.state.calendarData}/>\n                </div>\n                </div>\n                </div>\n            </div>\n        );\n    }\n }\n export default Delete;\n"]},"metadata":{},"sourceType":"module"}